<!DOCTYPE html><html lang=zh-Hans dir=ltr><meta charset=utf-8><title>ShiroSU 内核提权部分讲解 | ShiroSU</title><meta name=generator content="VitePress v2.0.0-alpha.8"><link rel="preload stylesheet" href=/assets/style.BOBv41YN.css as=style><link rel="preload stylesheet" href=/vp-icons.css as=style><script type=module src=/assets/chunks/metadata.5b641c99.js></script><script type=module src=/assets/app.DxnaQG9G.js></script><link rel=preload href=/assets/inter-roman-latin.Di8DUHzh.woff2 as=font type=font/woff2 crossorigin=""><link rel=modulepreload href=/assets/chunks/framework.DSr6HixA.js><link rel=modulepreload href=/assets/chunks/theme.B0X58nwi.js><link rel=modulepreload href=/assets/ssu_principle.md.0-Y4-29V.lean.js><link rel=preconnect href=https://ssu.noidx.sawahara.host crossorigin=""><link rel=dns-prefetch href=https://ssu.noidx.sawahara.host><link rel=preconnect href=https://d.alicdn.com crossorigin=""><link rel=dns-prefetch href=https://d.alicdn.com><link rel=preconnect href=https://fonts.googleapis.cn crossorigin=""><link rel=dns-prefetch href=https://fonts.googleapis.cn><link rel=preconnect href=https://fonts.gstatic.cn crossorigin=""><link rel=dns-prefetch href=https://fonts.gstatic.cn><link rel=stylesheet href="https://fonts.googleapis.cn/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&amp;family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&amp;display=swap"><link rel=icon href=https://ssu.noidx.sawahara.host/logo.webp><meta name=author content="安音咲汀, YumeYuka, Linso, 悠栾, 枫莹"><meta name=description content=简单易上手的root实现><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content=#3c8772><meta property=og:type content=website><meta property=og:locale content=zh_CN><meta property=og:title content=SSU><meta property=og:description content=简单易上手的root实现><meta property=og:url content=https://ssu.oom-wg.dev><meta property=og:site_name content=SSU><meta property=og:image content=https://ssu.noidx.sawahara.host/og-template.webp><meta property=og:image:alt content="SSU - 简单易上手的root实现"><meta property=og:image:width content=1200><meta property=og:image:height content=630><meta property=og:image:type content=image/webp><meta name=twitter:card content=summary_large_image><meta name=twitter:site content=@SSU><script>(function(a,n,t,o,u){a[o]=a[o]||[];var s=n.getElementsByTagName(t)[0],e=n.createElement(t);e.async=!0,e.id="beacon-aplus",e.src="https://d.alicdn.com/alilog/mlog/aplus/"+u+".js",e.onerror=function(){console.warn("\u8B66\u544A\uFF1A\u53CB\u76DF\u7EDF\u8BA1\u52A0\u8F7D\u5931\u8D25\uFF0C\u53EF\u80FD\u5DF2\u88AB\u5E7F\u544A\u62E6\u622A\u63D2\u4EF6\u62E6\u622A\u3002")},s.parentNode.insertBefore(e,s)})(window,document,"script","aplus_queue","203467608"),aplus_queue.push({action:"aplus.setMetaInfo",arguments:["appKey","6849a077bc47b67d8382f404"]});</script><script id=check-dark-mode>(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script><script id=check-mac-os>document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script><div id=app><!--[--><div class=Layout data-v-54776bf8><!--[--><!--[--><template><!----></template><!--[--><!--]--><!--]--><canvas style=position:fixed;left:0;top:0;pointer-events:none;z-index:999999 data-v-ef48b2af></canvas><canvas style=position:fixed;left:0;top:0;pointer-events:none;z-index:999999></canvas><!--]--><!--[--><span tabindex=-1 data-v-07817468></span><a href=#VPContent class="VPSkipLink visually-hidden" data-v-07817468>跳转到内容</a><!--]--><!----><header class=VPNav data-v-54776bf8 data-v-ceb6f60d><div class=VPNavBar data-v-ceb6f60d data-v-52882120><div class=wrapper data-v-52882120><div class=container data-v-52882120><div class=title data-v-52882120><div class="VPNavBarTitle has-sidebar" data-v-52882120 data-v-18e3ac99><a class=title href=/ data-v-18e3ac99><!--[--><!--]--><!--[--><img class="VPImage logo" src=https://ssu.noidx.sawahara.host/logo.webp alt data-v-85bc4f8d><!--]--><span data-v-18e3ac99>SSU</span><!--[--><!--]--></a></div></div><div class=content data-v-52882120><div class=content-body data-v-52882120><!--[--><!--]--><div class="VPNavBarSearch search" data-v-52882120><!----></div><nav aria-labelledby=main-nav-aria-label class="VPNavBarMenu menu" data-v-52882120 data-v-4cce4e3f><span id=main-nav-aria-label class=visually-hidden data-v-4cce4e3f>Main Navigation</span><!--[--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-4cce4e3f data-v-cd1080cf><button type=button class=button aria-haspopup=true aria-expanded=false data-v-cd1080cf><span class=text data-v-cd1080cf><!----><span data-v-cd1080cf>关于 SSU</span><span class="vpi-chevron-down text-icon" data-v-cd1080cf></span></span></button><div class=menu data-v-cd1080cf><div class=VPMenu data-v-cd1080cf data-v-3ffb2778><div class=items data-v-3ffb2778><!--[--><!--[--><div class=VPMenuLink data-v-3ffb2778 data-v-5b061ac4><a class="VPLink link" href=/base/feats data-v-5b061ac4><!--[--><span data-v-5b061ac4>特色功能</span><!--]--></a></div><!--]--><!--[--><div class=VPMenuLink data-v-3ffb2778 data-v-5b061ac4><a class="VPLink link" href=/ssu/team data-v-5b061ac4><!--[--><span data-v-5b061ac4>了解团队</span><!--]--></a></div><!--]--><!--[--><div class=VPMenuLink data-v-3ffb2778 data-v-5b061ac4><a class="VPLink link" href=/ssu/3q data-v-5b061ac4><!--[--><span data-v-5b061ac4>开发致谢</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-4cce4e3f data-v-cd1080cf><button type=button class=button aria-haspopup=true aria-expanded=false data-v-cd1080cf><span class=text data-v-cd1080cf><!----><span data-v-cd1080cf>版本更新</span><span class="vpi-chevron-down text-icon" data-v-cd1080cf></span></span></button><div class=menu data-v-cd1080cf><div class=VPMenu data-v-cd1080cf data-v-3ffb2778><div class=items data-v-3ffb2778><!--[--><!--[--><div class=VPMenuLink data-v-3ffb2778 data-v-5b061ac4><a class="VPLink link" href=/update/history data-v-5b061ac4><!--[--><span data-v-5b061ac4>历史版本</span><!--]--></a></div><!--]--><!--[--><div class=VPMenuLink data-v-3ffb2778 data-v-5b061ac4><a class="VPLink link" href=/update/changelog data-v-5b061ac4><!--[--><span data-v-5b061ac4>更新日志</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href=/more/translation tabindex=0 data-v-4cce4e3f data-v-e1c958ed><!--[--><span data-v-e1c958ed>文档翻译</span><!--]--></a><!--]--><!--]--></nav><div class="VPFlyout VPNavBarTranslations translations" data-v-52882120 data-v-59d99eb2 data-v-cd1080cf><button type=button class=button aria-haspopup=true aria-expanded=false aria-label=多语言 data-v-cd1080cf><span class=text data-v-cd1080cf><span class="vpi-languages option-icon" data-v-cd1080cf></span><!----><span class="vpi-chevron-down text-icon" data-v-cd1080cf></span></span></button><div class=menu data-v-cd1080cf><div class=VPMenu data-v-cd1080cf data-v-3ffb2778><!----><!--[--><!--[--><div class=items data-v-59d99eb2><p class=title data-v-59d99eb2>简体中文</p><!--[--><div class=VPMenuLink data-v-59d99eb2 data-v-5b061ac4><a class="VPLink link" href=/en/ssu/principle data-v-5b061ac4><!--[--><span data-v-5b061ac4>English</span><!--]--></a></div><div class=VPMenuLink data-v-59d99eb2 data-v-5b061ac4><a class="VPLink link" href=/ja/ssu/principle data-v-5b061ac4><!--[--><span data-v-5b061ac4>日本語</span><!--]--></a></div><!--]--></div><!--]--><!--]--></div></div></div><div class="VPNavBarAppearance appearance" data-v-52882120 data-v-56ec8d55><button class="VPSwitch VPSwitchAppearance" type=button role=switch title aria-checked=false data-v-56ec8d55 data-v-d6dde4cb data-v-3186a66d><span class=check data-v-3186a66d><span class=icon data-v-3186a66d><!--[--><span class="vpi-sun sun" data-v-d6dde4cb></span><span class="vpi-moon moon" data-v-d6dde4cb></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-52882120 data-v-0133afe4 data-v-e2e47ec9><!--[--><a class="VPSocialLink no-icon" href=https://github.com/OOM-WG/SSU_Docs aria-label=github target=_blank rel=noopener data-v-e2e47ec9 data-v-fd879f89><span class=vpi-social-github></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-52882120 data-v-6d9fdb95 data-v-cd1080cf><button type=button class=button aria-haspopup=true aria-expanded=false aria-label="extra navigation" data-v-cd1080cf><span class="vpi-more-horizontal icon" data-v-cd1080cf></span></button><div class=menu data-v-cd1080cf><div class=VPMenu data-v-cd1080cf data-v-3ffb2778><!----><!--[--><!--[--><div class="group translations" data-v-6d9fdb95><p class=trans-title data-v-6d9fdb95>简体中文</p><!--[--><div class=VPMenuLink data-v-6d9fdb95 data-v-5b061ac4><a class="VPLink link" href=/en/ssu/principle data-v-5b061ac4><!--[--><span data-v-5b061ac4>English</span><!--]--></a></div><div class=VPMenuLink data-v-6d9fdb95 data-v-5b061ac4><a class="VPLink link" href=/ja/ssu/principle data-v-5b061ac4><!--[--><span data-v-5b061ac4>日本語</span><!--]--></a></div><!--]--></div><div class=group data-v-6d9fdb95><div class="item appearance" data-v-6d9fdb95><p class=label data-v-6d9fdb95>主题<div class=appearance-action data-v-6d9fdb95><button class="VPSwitch VPSwitchAppearance" type=button role=switch title aria-checked=false data-v-6d9fdb95 data-v-d6dde4cb data-v-3186a66d><span class=check data-v-3186a66d><span class=icon data-v-3186a66d><!--[--><span class="vpi-sun sun" data-v-d6dde4cb></span><span class="vpi-moon moon" data-v-d6dde4cb></span><!--]--></span></span></button></div></div></div><div class=group data-v-6d9fdb95><div class="item social-links" data-v-6d9fdb95><div class="VPSocialLinks social-links-list" data-v-6d9fdb95 data-v-e2e47ec9><!--[--><a class="VPSocialLink no-icon" href=https://github.com/OOM-WG/SSU_Docs aria-label=github target=_blank rel=noopener data-v-e2e47ec9 data-v-fd879f89><span class=vpi-social-github></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--[--><!--[--><!--[--><div class="VPFlyout VPNolebaseEnhancedReadabilitiesMenu VPNolebaseEnhancedReadabilitiesMenuFlyout" aria-label=阅读增强 role=menuitem data-v-cd1080cf><button type=button class=button aria-haspopup=true aria-expanded=false data-v-cd1080cf><span class=text data-v-cd1080cf><span class="i-icon-park-outline:book-open option-icon" data-v-cd1080cf></span><!----><span class="vpi-chevron-down text-icon" data-v-cd1080cf></span></span></button><div class=menu data-v-cd1080cf><div class=VPMenu data-v-cd1080cf data-v-3ffb2778><!----><!--[--><!--]--></div></div></div><!--]--><!--]--><!--]--><!--]--><button type=button class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded=false aria-controls=VPNavScreen data-v-52882120 data-v-557a4854><span class=container data-v-557a4854><span class=top data-v-557a4854></span><span class=middle data-v-557a4854></span><span class=bottom data-v-557a4854></span></span></button></div></div></div></div><div class=divider data-v-52882120><div class=divider-line data-v-52882120></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-54776bf8 data-v-d95b234f><div class=container data-v-d95b234f><button class=menu aria-expanded=false aria-controls=VPSidebarNav data-v-d95b234f><span class="vpi-align-left menu-icon" data-v-d95b234f></span><span class=menu-text data-v-d95b234f>菜单</span></button><div class=VPLocalNavOutlineDropdown style=--vp-vh:0px data-v-d95b234f data-v-8828559c><button data-v-8828559c>回到顶部</button><!----></div></div></div><aside class=VPSidebar data-v-54776bf8 data-v-67943f10><div class=curtain data-v-67943f10></div><nav class=nav id=VPSidebarNav aria-labelledby=sidebar-aria-label tabindex=-1 data-v-67943f10><span class=visually-hidden id=sidebar-aria-label data-v-67943f10>Sidebar Navigation</span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-b4e376da><section class="VPSidebarItem level-0 collapsible" data-v-b4e376da data-v-20ee7e48><div class=item role=button tabindex=0 data-v-20ee7e48><div class=indicator data-v-20ee7e48></div><h2 class=text data-v-20ee7e48>使用指南</h2><div class=caret role=button aria-label="toggle section" tabindex=0 data-v-20ee7e48><span class="vpi-chevron-right caret-icon" data-v-20ee7e48></span></div></div><div class=items data-v-20ee7e48><!--[--><div class="VPSidebarItem level-1 is-link" data-v-20ee7e48 data-v-20ee7e48><div class=item data-v-20ee7e48><div class=indicator data-v-20ee7e48></div><a class="VPLink link link" href=/base/overview data-v-20ee7e48><!--[--><p class=text data-v-20ee7e48>什么是 SSU</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-20ee7e48 data-v-20ee7e48><div class=item data-v-20ee7e48><div class=indicator data-v-20ee7e48></div><a class="VPLink link link" href=/base/install data-v-20ee7e48><!--[--><p class=text data-v-20ee7e48>安装指南</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-20ee7e48 data-v-20ee7e48><div class=item data-v-20ee7e48><div class=indicator data-v-20ee7e48></div><a class="VPLink link link" href=/base/faq data-v-20ee7e48><!--[--><p class=text data-v-20ee7e48>常见问题</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-b4e376da><section class="VPSidebarItem level-0 collapsible" data-v-b4e376da data-v-20ee7e48><div class=item role=button tabindex=0 data-v-20ee7e48><div class=indicator data-v-20ee7e48></div><h2 class=text data-v-20ee7e48>面向开发者</h2><div class=caret role=button aria-label="toggle section" tabindex=0 data-v-20ee7e48><span class="vpi-chevron-right caret-icon" data-v-20ee7e48></span></div></div><div class=items data-v-20ee7e48><!--[--><div class="VPSidebarItem level-1 is-link" data-v-20ee7e48 data-v-20ee7e48><div class=item data-v-20ee7e48><div class=indicator data-v-20ee7e48></div><a class="VPLink link link" href=/dev/module data-v-20ee7e48><!--[--><p class=text data-v-20ee7e48>模块开发</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-20ee7e48 data-v-20ee7e48><div class=item data-v-20ee7e48><div class=indicator data-v-20ee7e48></div><a class="VPLink link link" href=/dev/webui data-v-20ee7e48><!--[--><p class=text data-v-20ee7e48>模块 WebUI</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-20ee7e48 data-v-20ee7e48><div class=item data-v-20ee7e48><div class=indicator data-v-20ee7e48></div><a class="VPLink link link" href=/dev/scheme data-v-20ee7e48><!--[--><p class=text data-v-20ee7e48>Scheme 调用</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-b4e376da><section class="VPSidebarItem level-0 collapsible has-active" data-v-b4e376da data-v-20ee7e48><div class=item role=button tabindex=0 data-v-20ee7e48><div class=indicator data-v-20ee7e48></div><h2 class=text data-v-20ee7e48>关于 SSU</h2><div class=caret role=button aria-label="toggle section" tabindex=0 data-v-20ee7e48><span class="vpi-chevron-right caret-icon" data-v-20ee7e48></span></div></div><div class=items data-v-20ee7e48><!--[--><div class="VPSidebarItem level-1 is-link" data-v-20ee7e48 data-v-20ee7e48><div class=item data-v-20ee7e48><div class=indicator data-v-20ee7e48></div><a class="VPLink link link" href=/ssu/origin data-v-20ee7e48><!--[--><p class=text data-v-20ee7e48>一切的起源</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-20ee7e48 data-v-20ee7e48><div class=item data-v-20ee7e48><div class=indicator data-v-20ee7e48></div><a class="VPLink link link" href=/ssu/principle data-v-20ee7e48><!--[--><p class=text data-v-20ee7e48>内核工作原理</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-20ee7e48 data-v-20ee7e48><div class=item data-v-20ee7e48><div class=indicator data-v-20ee7e48></div><a class="VPLink link link" href=/ssu/defense data-v-20ee7e48><!--[--><p class=text data-v-20ee7e48>面对质疑</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--[--><!--[--><div class=music-player style="--476f6951:rgba(255, 255, 255, 0.95);--4fb081d7:blur(10px);--2f705d76:12px;--764d4303:rgba(255, 255, 255, 0.98);--22d4ed1a:blur(12px);--309aa886:rgba(24, 24, 27, 0.95);--5c0dd5b8:rgba(24, 24, 27, 0.98)" data-v-76dc7cc5><div class=music-player-collapsed data-v-76dc7cc5><div class=collapsed-content data-v-76dc7cc5><div class=cover-image data-v-76dc7cc5><img src=/assets/music/1.png alt=Serenity data-v-76dc7cc5></div><button class="__button-elmmp n-button n-button--primary-type n-button--medium-type main-play-btn" tabindex=0 type=button style="" data-v-76dc7cc5><!----><span class=n-button__icon style=margin:0><div class=n-icon-slot role=none><i role=img class="n-icon __icon-d" style=font-size:18px data-v-76dc7cc5><svg xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink viewBox="0 0 512 512" data-v-76dc7cc5><path d="M133 440a35.37 35.37 0 0 1-17.5-4.67c-12-6.8-19.46-20-19.46-34.33V111c0-14.37 7.46-27.53 19.46-34.33a35.13 35.13 0 0 1 35.77.45l247.85 148.36a36 36 0 0 1 0 61l-247.89 148.4A35.5 35.5 0 0 1 133 440z" fill=currentColor></path></svg></i></div></span><!----><div aria-hidden=true class=n-base-wave></div><div aria-hidden=true class=n-button__border style=""></div><div aria-hidden=true class=n-button__state-border style=""></div></button></div></div><audio data-v-76dc7cc5><source src=/assets/music/Bande-annonce.mp3 type=audio/mpeg data-v-76dc7cc5></audio></div><!--]--><!--]--><!--]--></nav></aside><div class="VPContent has-sidebar" id=VPContent data-v-54776bf8 data-v-e977351c><div class="VPDoc has-sidebar has-aside" data-v-e977351c data-v-0e4ff3bd><!--[--><!--]--><div class=container data-v-0e4ff3bd><div class=aside data-v-0e4ff3bd><div class=aside-curtain data-v-0e4ff3bd></div><div class=aside-container data-v-0e4ff3bd><div class=aside-content data-v-0e4ff3bd><div class=VPDocAside data-v-0e4ff3bd data-v-345089ee><!--[--><!--[--><!--[--><!--[--><!--[--><div class=carousel-container data-v-f610bb4b><div class="__carousel n-carousel n-carousel--bottom n-carousel--horizontal n-carousel--slide" style="" data-v-f610bb4b><!--[--><div class=n-carousel__slides role=listbox style=transition-duration:.3s;transform:translateX(0)><div class=n-carousel__slide role=option tabindex=-1 data-index=-1 aria-hidden=true style=""><img class=carousel-img src=/assets/carousel/2.png data-v-f610bb4b></div><div class=n-carousel__slide role=option tabindex=-1 data-index=-1 aria-hidden=true style=""><img class=carousel-img src=/assets/carousel/1.png data-v-f610bb4b></div><div class=n-carousel__slide role=option tabindex=-1 data-index=-1 aria-hidden=true style=""><img class=carousel-img src=/assets/carousel/2.png data-v-f610bb4b></div><div class=n-carousel__slide role=option tabindex=-1 data-index=-1 aria-hidden=true style=""><img class=carousel-img src=/assets/carousel/1.png data-v-f610bb4b></div></div><!--]--><!----><!----></div></div><div class=article-share data-v-76cb3b83><button class=article-share__button aria-label=分享链接 disabled aria-live=polite data-v-76cb3b83><div class=content-wrapper data-v-76cb3b83><span class=icon data-v-76cb3b83><svg xmlns=http://www.w3.org/2000/svg width=16 height=16 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2 stroke-linecap=round stroke-linejoin=round><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path><polyline points="16 6 12 2 8 6"></polyline><line x1=12 y1=2 x2=12 y2=15></line></svg></span>分享链接</div></button></div><!--]--><!--]--><!--]--><!--]--><!--]--><!--[--><!--]--><nav aria-labelledby=doc-outline-aria-label class=VPDocAsideOutline data-v-345089ee data-v-afe8fdb1><div class=content data-v-afe8fdb1><div class=outline-marker data-v-afe8fdb1></div><div aria-level=2 class=outline-title id=doc-outline-aria-label role=heading data-v-afe8fdb1>页面导航</div><ul class="VPDocOutlineItem root" data-v-afe8fdb1 data-v-b1fe7164><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class=spacer data-v-345089ee></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class=content data-v-0e4ff3bd><div class=content-container data-v-0e4ff3bd><!--[--><!--]--><main class=main data-v-0e4ff3bd><div style=position:relative class="vp-doc _ssu_principle" data-v-0e4ff3bd><div><h1 id=shirosu-内核提权部分讲解 tabindex=-1>ShiroSU 内核提权部分讲解<a class=header-anchor href=#shirosu-内核提权部分讲解 aria-label="Permalink to “ShiroSU 内核提权部分讲解”">​</a></h1><div class=word><p><svg t=1724572866572 class=icon viewBox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg p-id=18131 width=16 height=16><path d="M168.021333 504.192A343.253333 343.253333 0 0 1 268.629333 268.8a342.229333 342.229333 0 0 1 243.285334-100.778667A341.504 341.504 0 0 1 755.029333 268.8c9.856 9.898667 19.2 20.394667 27.733334 31.402667l-60.16 46.976a8.021333 8.021333 0 0 0 2.986666 14.122666l175.701334 43.008a8.021333 8.021333 0 0 0 9.898666-7.68l0.810667-180.906666a7.936 7.936 0 0 0-12.885333-6.314667L842.666667 253.44a418.858667 418.858667 0 0 0-330.922667-161.493333c-229.12 0-415.488 183.594667-419.797333 411.818666a8.021333 8.021333 0 0 0 8.021333 8.192H160a7.978667 7.978667 0 0 0 8.021333-7.808zM923.946667 512H864a7.978667 7.978667 0 0 0-8.021333 7.808 341.632 341.632 0 0 1-26.88 125.994667 342.186667 342.186667 0 0 1-73.685334 109.397333 342.442667 342.442667 0 0 1-243.328 100.821333 342.229333 342.229333 0 0 1-270.976-132.224l60.16-46.976a8.021333 8.021333 0 0 0-2.986666-14.122666l-175.701334-43.008a8.021333 8.021333 0 0 0-9.898666 7.68l-0.682667 181.034666c0 6.698667 7.68 10.496 12.885333 6.314667L181.333333 770.56a419.072 419.072 0 0 0 330.922667 161.408c229.205333 0 415.488-183.722667 419.797333-411.818667a8.021333 8.021333 0 0 0-8.021333-8.192z" fill=#8a8a8a p-id=18132></path></svg>更新: 8/20/2025<svg t=1724571760788 class=icon viewBox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg p-id=6125 width=16 height=16><path d="M204.8 0h477.866667l273.066666 273.066667v614.4c0 75.093333-61.44 136.533333-136.533333 136.533333H204.8c-75.093333 0-136.533333-61.44-136.533333-136.533333V136.533333C68.266667 61.44 129.706667 0 204.8 0z m307.2 607.573333l68.266667 191.146667c13.653333 27.306667 54.613333 27.306667 61.44 0l102.4-273.066667c6.826667-20.48 0-34.133333-20.48-40.96s-34.133333 0-40.96 13.653334l-68.266667 191.146666-68.266667-191.146666c-13.653333-27.306667-54.613333-27.306667-68.266666 0l-68.266667 191.146666-68.266667-191.146666c-6.826667-13.653333-27.306667-27.306667-47.786666-20.48s-27.306667 27.306667-20.48 47.786666l102.4 273.066667c13.653333 27.306667 54.613333 27.306667 61.44 0l75.093333-191.146667z" fill=#777777 p-id=6126></path><path d="M682.666667 0l273.066666 273.066667h-204.8c-40.96 0-68.266667-27.306667-68.266666-68.266667V0z" fill=#E0E0E0 opacity=.619 p-id=6127></path></svg>字数: 0 字<svg t=1724572797268 class=icon viewBox="0 0 1060 1024" version=1.1 xmlns=http://www.w3.org/2000/svg p-id=15031 width=16 height=16><path d="M556.726857 0.256A493.933714 493.933714 0 0 0 121.929143 258.998857L0 135.021714v350.390857h344.649143L196.205714 334.482286a406.820571 406.820571 0 1 1-15.908571 312.649143H68.937143A505.819429 505.819429 0 1 0 556.726857 0.256z m-79.542857 269.531429v274.907428l249.197714 150.966857 42.422857-70.070857-212.114285-129.389714V269.787429h-79.542857z" fill=#8a8a8a p-id=15032></path></svg>时长: 0 分钟</div><div my-4 class="vp-nolebase-page-properties vp-nolebase-page-properties-container"><div class="vp-nolebase-page-properties-grid grid grid-cols-[180px_auto] gap-1 &lt;sm:grid-cols-[120px_auto]"><!--[--><!--]--></div></div><h2 id=_1-概述 tabindex=-1>1. 概述<a class=header-anchor href=#_1-概述 aria-label="Permalink to “1. 概述”">​</a></h2><p>ShiroSU 内核部分 是一个针对 Android 内核的提权与 Selinux 处理的部分：<ul><li><strong>root 权限提升</strong>：自动将指定进程提权为 root。<li><strong>能力管理绕过</strong>：通过 hook 能力检查函数，绕过 Linux 能力限制。<li><strong>SELinux 绕过</strong>：hook SELinux 访问控制，允许敏感操作。<li><strong>动态进程监控</strong>：监控<code>su</code>执行自动触发提权操作。</ul><hr><h2 id=_2-技术架构与核心机制 tabindex=-1>2. 技术架构与核心机制<a class=header-anchor href=#_2-技术架构与核心机制 aria-label="Permalink to “2. 技术架构与核心机制”">​</a></h2><h3 id=_2-1-关键-hook-点与探针部署 tabindex=-1>2.1 关键 Hook 点与探针部署<a class=header-anchor href=#_2-1-关键-hook-点与探针部署 aria-label="Permalink to “2.1 关键 Hook 点与探针部署”">​</a></h3><table tabindex=0><thead><tr><th>探针类型<th>Hook 函数<th>功能说明<tbody><tr><td>kprobe<td>sys_execve (按情况)<td>监控敏感命令执行，触发提权<tr><td>kretprobe<td>cap_capable<td>绕过 Linux 能力检查<tr><td>kretprobe<td>avc_denied<td>绕过 SELinux 访问控制</table><h4 id=探针注册流程 tabindex=-1>探针注册流程<a class=header-anchor href=#探针注册流程 aria-label="Permalink to “探针注册流程”">​</a></h4><div align=center><div class="mermaid my-class"></div></div><hr><h3 id=_2-2-核心提权逻辑 tabindex=-1>2.2 核心提权逻辑<a class=header-anchor href=#_2-2-核心提权逻辑 aria-label="Permalink to “2.2 核心提权逻辑”">​</a></h3><h4 id=部分代码片段 tabindex=-1>部分代码片段<a class=header-anchor href=#部分代码片段 aria-label="Permalink to “部分代码片段”">​</a></h4><div class=language-c><button title="Copy Code" class=copy></button><span class=lang>c</span><pre class="shiki shiki-themes github-light github-dark-dimmed" style=--shiki-light:#24292e;--shiki-dark:#adbac7;--shiki-light-bg:#fff;--shiki-dark-bg:#22272e tabindex=0 dir=ltr><code><span class=line><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>struct</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7> cred </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>*</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>cred </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>=</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7> (</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>struct</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7> cred </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>*</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>)</span><span style=--shiki-light:#6F42C1;--shiki-dark:#DCBDFB>__task_cred</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>(current);</span></span>
<span class=line></span>
<span class=line><span style=--shiki-light:#6A737D;--shiki-dark:#768390>// 1. 提权为 root</span></span>
<span class=line><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>cred</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>-&gt;</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>uid </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>=</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7> cred</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>-&gt;</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>euid </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>=</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7> cred</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>-&gt;</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>suid </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>=</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7> cred</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>-&gt;</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>fsuid </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>=</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7> GLOBAL_ROOT_UID;</span></span>
<span class=line><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>cred</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>-&gt;</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>gid </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>=</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7> cred</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>-&gt;</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>egid </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>=</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7> cred</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>-&gt;</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>sgid </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>=</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7> cred</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>-&gt;</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>fsgid </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>=</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7> GLOBAL_ROOT_GID;</span></span>
<span class=line><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>cred</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>-&gt;</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>securebits </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>=</span><span style=--shiki-light:#005CC5;--shiki-dark:#6CB6FF> 0</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>;</span></span>
<span class=line></span>
<span class=line><span style=--shiki-light:#6A737D;--shiki-dark:#768390>// 2. 赋予所有能力</span></span>
<span class=line><span style=--shiki-light:#6F42C1;--shiki-dark:#DCBDFB>memset</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>(</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>&amp;</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>cred</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>-&gt;</span><span style=--shiki-light:#E36209;--shiki-dark:#F69D50>cap_inheritable</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>, </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>0x</span><span style=--shiki-light:#005CC5;--shiki-dark:#6CB6FF>ff</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>, </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>sizeof</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>(</span><span style=--shiki-light:#005CC5;--shiki-dark:#6CB6FF>kernel_cap_t</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>));</span></span>
<span class=line><span style=--shiki-light:#6F42C1;--shiki-dark:#DCBDFB>memset</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>(</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>&amp;</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>cred</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>-&gt;</span><span style=--shiki-light:#E36209;--shiki-dark:#F69D50>cap_permitted</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>, </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>0x</span><span style=--shiki-light:#005CC5;--shiki-dark:#6CB6FF>ff</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>, </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>sizeof</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>(</span><span style=--shiki-light:#005CC5;--shiki-dark:#6CB6FF>kernel_cap_t</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>));</span></span>
<span class=line><span style=--shiki-light:#6F42C1;--shiki-dark:#DCBDFB>memset</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>(</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>&amp;</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>cred</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>-&gt;</span><span style=--shiki-light:#E36209;--shiki-dark:#F69D50>cap_effective</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>, </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>0x</span><span style=--shiki-light:#005CC5;--shiki-dark:#6CB6FF>ff</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>, </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>sizeof</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>(</span><span style=--shiki-light:#005CC5;--shiki-dark:#6CB6FF>kernel_cap_t</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>));</span></span>
<span class=line><span style=--shiki-light:#6F42C1;--shiki-dark:#DCBDFB>memset</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>(</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>&amp;</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>cred</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>-&gt;</span><span style=--shiki-light:#E36209;--shiki-dark:#F69D50>cap_bset</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>, </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>0x</span><span style=--shiki-light:#005CC5;--shiki-dark:#6CB6FF>ff</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>, </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>sizeof</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>(</span><span style=--shiki-light:#005CC5;--shiki-dark:#6CB6FF>kernel_cap_t</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>));</span></span>
<span class=line><span style=--shiki-light:#6F42C1;--shiki-dark:#DCBDFB>memset</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>(</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>&amp;</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>cred</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>-&gt;</span><span style=--shiki-light:#E36209;--shiki-dark:#F69D50>cap_ambient</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>, </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>0x</span><span style=--shiki-light:#005CC5;--shiki-dark:#6CB6FF>ff</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>, </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>sizeof</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>(</span><span style=--shiki-light:#005CC5;--shiki-dark:#6CB6FF>kernel_cap_t</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>));</span></span>
<span class=line></span>
<span class=line><span style=--shiki-light:#6A737D;--shiki-dark:#768390>// 3. 关闭 seccomp (部分需要依情况)</span></span>
<span class=line><span style=--shiki-light:#6F42C1;--shiki-dark:#DCBDFB>current_thread_info</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>()</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>-&gt;</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>syscall_work </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>&amp;=</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067> ~</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>SYSCALL_WORK_SECCOMP;</span></span>
<span class=line><span style=--shiki-light:#6F42C1;--shiki-dark:#DCBDFB>current_thread_info</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>()</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>-&gt;</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>flags </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>&amp;=</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067> ~</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>(TIF_SECCOMP </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>|</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7> _TIF_SECCOMP);</span></span>
<span class=line><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>current</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>-&gt;</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>seccomp.mode </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>=</span><span style=--shiki-light:#005CC5;--shiki-dark:#6CB6FF> 0</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>;</span></span>
<span class=line><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>current</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>-&gt;</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>seccomp.filter </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>=</span><span style=--shiki-light:#005CC5;--shiki-dark:#6CB6FF> NULL</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>;</span></span>
<span class=line></span>
<span class=line><span style=--shiki-light:#6A737D;--shiki-dark:#768390>// 4. 设置 root 组</span></span>
<span class=line><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>if</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7> (cred</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>-&gt;</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>group_info) {</span></span>
<span class=line><span style=--shiki-light:#6A737D;--shiki-dark:#768390>    // 设置组为 root ...</span></span>
<span class=line><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>}</span></span></code></pre></div><p><strong>详细说明：</strong><ul><li><strong>UID/GID 提升</strong>：将当前进程的所有用户和组 ID 设为 0，获得<code>root</code>身份。<li><strong>能力位全开</strong>：Linux 的<code>capability</code>机制用于细粒度权限控制，全部置<code>1</code>后进程拥有所有内核能力。<li><strong>关闭 seccomp</strong>：<code>seccomp</code>是 Linux 的系统调用过滤机制，关闭后进程可自由调用所有系统调用。<li><strong>组信息 root 化</strong>：将进程的<code>group_info</code>指向<code>root</code>组，避免组权限限制。</ul><hr><h3 id=_2-3-selinux-绕过机制 tabindex=-1>2.3 SELinux 绕过机制<a class=header-anchor href=#_2-3-selinux-绕过机制 aria-label="Permalink to “2.3 SELinux 绕过机制”">​</a></h3><h4 id=部分代码片段-1 tabindex=-1>部分代码片段<a class=header-anchor href=#部分代码片段-1 aria-label="Permalink to “部分代码片段”">​</a></h4><div class=language-c><button title="Copy Code" class=copy></button><span class=lang>c</span><pre class="shiki shiki-themes github-light github-dark-dimmed" style=--shiki-light:#24292e;--shiki-dark:#adbac7;--shiki-light-bg:#fff;--shiki-dark-bg:#22272e tabindex=0 dir=ltr><code><span class=line><span style=--shiki-light:#6A737D;--shiki-dark:#768390>// avc_denied kretprobe handler</span></span>
<span class=line></span>
<span class=line><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>if</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7> (current</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>-&gt;</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>real_cred</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>-&gt;</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>uid.val </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>==</span><span style=--shiki-light:#6A737D;--shiki-dark:#768390> /* 白名单 UID */</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>) {</span></span>
<span class=line><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>    regs-&gt;regs[</span><span style=--shiki-light:#005CC5;--shiki-dark:#6CB6FF>0</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>] </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>=</span><span style=--shiki-light:#005CC5;--shiki-dark:#6CB6FF> 0</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>;</span><span style=--shiki-light:#6A737D;--shiki-dark:#768390>  // 白名单 UID 直接设置允许</span></span>
<span class=line><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>} </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>else</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067> if</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7> (</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>!</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>current</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>-&gt;</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>real_cred</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>-&gt;</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>uid.val) {</span></span>
<span class=line><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>    regs-&gt;regs[</span><span style=--shiki-light:#005CC5;--shiki-dark:#6CB6FF>0</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>] </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>=</span><span style=--shiki-light:#005CC5;--shiki-dark:#6CB6FF> 0</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>;</span><span style=--shiki-light:#6A737D;--shiki-dark:#768390>  // root 同样设置允许</span></span>
<span class=line><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>}</span></span></code></pre></div><p><strong>详细说明：</strong><ul><li><strong>SELinux 机制</strong>：<code>SELinux</code>通过访问控制决策函数（如<code>avc_denied</code>）限制进程访问资源。<li><strong>kretprobe hook</strong>：模块通过 kretprobe hook<code>avc_denied</code>，在该函数返回时劫持返回值。<li><strong>UID 检查</strong>：仅对特定<code>UID</code>（如<code>ShiroSU 管理器</code>以及由用户设置的白名单 UID）或<code>root</code>生效。<li><strong>强制放行</strong>：将返回值设为 0，表示访问被允许，从而绕过 SELinux 的安全策略。</ul><hr><h3 id=_2-4-能力检查绕过-cap-capable tabindex=-1>2.4 能力检查绕过（cap_capable）<a class=header-anchor href=#_2-4-能力检查绕过-cap-capable aria-label="Permalink to “2.4 能力检查绕过（cap_capable）”">​</a></h3><h4 id=部分代码片段-2 tabindex=-1>部分代码片段<a class=header-anchor href=#部分代码片段-2 aria-label="Permalink to “部分代码片段”">​</a></h4><div class=language-c><button title="Copy Code" class=copy></button><span class=lang>c</span><pre class="shiki shiki-themes github-light github-dark-dimmed" style=--shiki-light:#24292e;--shiki-dark:#adbac7;--shiki-light-bg:#fff;--shiki-dark-bg:#22272e tabindex=0 dir=ltr><code><span class=line><span style=--shiki-light:#6A737D;--shiki-dark:#768390>// cap_capable kretprobe handler</span></span>
<span class=line></span>
<span class=line><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>if</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7> (current</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>-&gt;</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>real_cred</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>-&gt;</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>uid.val </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>==</span><span style=--shiki-light:#6A737D;--shiki-dark:#768390> /* 白名单 UID */</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>) {</span></span>
<span class=line><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>    regs-&gt;regs[</span><span style=--shiki-light:#005CC5;--shiki-dark:#6CB6FF>0</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>] </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>=</span><span style=--shiki-light:#005CC5;--shiki-dark:#6CB6FF> 0</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>;</span><span style=--shiki-light:#6A737D;--shiki-dark:#768390>  // 白名单 UID 直接设置允许</span></span>
<span class=line><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>} </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>else</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067> if</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7> (</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>!</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>current</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>-&gt;</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>real_cred</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>-&gt;</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>uid.val) {</span></span>
<span class=line><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>    regs-&gt;regs[</span><span style=--shiki-light:#005CC5;--shiki-dark:#6CB6FF>0</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>] </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>=</span><span style=--shiki-light:#005CC5;--shiki-dark:#6CB6FF> 0</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>;</span><span style=--shiki-light:#6A737D;--shiki-dark:#768390>  // root 同样设置允许</span></span>
<span class=line><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>}</span></span></code></pre></div><p><strong>详细说明：</strong><ul><li><strong>cap_capable</strong>：Linux 内核能力检查的核心函数。<li><strong>kretprobe hook</strong>：在能力检查返回时劫持返回值。<li><strong>UID 检查与放行</strong>：对指定<code>UID</code>或<code>root</code>直接返回允许，绕过所有<code>capability</code>检查。</ul><hr><h3 id=_2-5-进程监控与自动提权 tabindex=-1>2.5 进程监控与自动提权<a class=header-anchor href=#_2-5-进程监控与自动提权 aria-label="Permalink to “2.5 进程监控与自动提权”">​</a></h3><ul><li>通过 kprobe hook<code>sys_execve</code>(具体地址名称需要依内核版本以及架构而定)，监控进程执行<code>su</code>。<li>检测到执行<code>su</code>时，自动调用提权函数实现提权。</ul><div class="language-c line-numbers-mode"><button title="Copy Code" class=copy></button><span class=lang>c</span><pre class="shiki shiki-themes github-light github-dark-dimmed" style=--shiki-light:#24292e;--shiki-dark:#adbac7;--shiki-light-bg:#fff;--shiki-dark-bg:#22272e tabindex=0 dir=ltr><code><span class=line><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>char</span><span style=--shiki-light:#E36209;--shiki-dark:#F69D50> buf</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>[</span><span style=--shiki-light:#005CC5;--shiki-dark:#6CB6FF>128</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>] </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>=</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7> {</span><span style=--shiki-light:#005CC5;--shiki-dark:#6CB6FF>0</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>};</span></span>
<span class=line><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>struct</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7> Param param;</span></span>
<span class=line><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>param </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>=</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067> *</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>(</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>struct</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7> Param </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>*</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>)regs</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>-&gt;</span><span style=--shiki-light:#E36209;--shiki-dark:#F69D50>regs</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>[</span><span style=--shiki-light:#005CC5;--shiki-dark:#6CB6FF>0</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>];</span></span>
<span class=line><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>if</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7> (</span><span style=--shiki-light:#6F42C1;--shiki-dark:#DCBDFB>copy_from_user</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>(buf, param.filename, </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>sizeof</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>(buf) </span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>-</span><span style=--shiki-light:#005CC5;--shiki-dark:#6CB6FF> 1</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>))</span></span>
<span class=line><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>    return</span><span style=--shiki-light:#005CC5;--shiki-dark:#6CB6FF> 0</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>;</span></span>
<span class=line></span>
<span class=line><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>if</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7> (</span><span style=--shiki-light:#D73A49;--shiki-dark:#F47067>!</span><span style=--shiki-light:#6F42C1;--shiki-dark:#DCBDFB>strcmp</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>(buf, </span><span style=--shiki-light:#032F62;--shiki-dark:#96D0FF>&quot;/system/bin/su&quot;</span><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>)) {</span></span>
<span class=line><span style=--shiki-light:#6A737D;--shiki-dark:#768390>    // 提权进程为 root ...</span></span>
<span class=line><span style=--shiki-light:#24292E;--shiki-dark:#ADBAC7>}</span></span></code></pre><div class=line-numbers-wrapper aria-hidden=true><span class=line-number>1</span><br><span class=line-number>2</span><br><span class=line-number>3</span><br><span class=line-number>4</span><br><span class=line-number>5</span><br><span class=line-number>6</span><br><span class=line-number>7</span><br><span class=line-number>8</span><br><span class=line-number>9</span><br></div></div><p><strong>说明：</strong><ul><li>监控<code>su</code>执行，自动提权为<code>root</code>。</ul><hr><h2 id=_3-声明 tabindex=-1>3. 声明<a class=header-anchor href=#_3-声明 aria-label="Permalink to “3. 声明”">​</a></h2><h3 id=_3-1-文档说明 tabindex=-1>3.1 文档说明<a class=header-anchor href=#_3-1-文档说明 aria-label="Permalink to “3.1 文档说明”">​</a></h3><ul><li>本文档所展示的代码为 ShiroSU 内核的部分测试代码或伪代码，部分为测试用例，代码质量和完整性可能有限，请嘴下留情。<li>本文档主要目的是展示内核代码的持续进步，证明这些并非空壳代码</ul><h3 id=_3-2-其他声明 tabindex=-1>3.2 其他声明<a class=header-anchor href=#_3-2-其他声明 aria-label="Permalink to “3.2 其他声明”">​</a></h3><ul><li><code>O.O.M. W.G.</code>致力于技术交流与社区建设，尊重每一位开发者的努力与成果。</ul><!--[--><h2 id=贡献者>贡献者<a class=header-anchor href=#贡献者 aria-label="Permalink to &#39;贡献者&#39;"></a></h2><div class="vp-nolebase-git-changelog vp-nolebase-git-changelog-contributors vp-nolebase-git-changelog-contributors-container vp-nolebase-git-changelog-contributors-list" flex flex-wrap gap-4 pt-2><!--[--><!--[--><a href=https://github.com/ShIroRRen class="no-icon flex items-center gap-2"><img src=https://github.com/ShIroRRen.png alt="The avatar of contributor named as 白彩恋" class="h-8 w-8 rounded-full"> 白彩恋</a><!--]--><!--[--><a href=https://github.com/YumeYuka class="no-icon flex items-center gap-2"><img src=https://github.com/YumeYuka.png alt="The avatar of contributor named as YumeYuka" class="h-8 w-8 rounded-full"> YumeYuka</a><!--]--><!--[--><a href=https://github.com/Linso05 class="no-icon flex items-center gap-2"><img src=https://github.com/Linso05.png alt="The avatar of contributor named as Linso" class="h-8 w-8 rounded-full"> Linso</a><!--]--><!--[--><a href=https://github.com/TianwanTW class="no-icon flex items-center gap-2"><img src=https://github.com/TianwanTW.png alt="The avatar of contributor named as 天绾绮奈" class="h-8 w-8 rounded-full"> 天绾绮奈</a><!--]--><!--]--></div><!--]--><!--[--><h2 id=页面历史 data-v-90d60066>页面历史<a class=header-anchor href=#页面历史 aria-label="Permalink to &#39;页面历史&#39;" data-v-90d60066></a></h2><div class="bg-$vp-custom-block-details-bg vp-nolebase-git-changelog vp-nolebase-git-changelog-history vp-nolebase-git-changelog-history-list vp-nolebase-git-changelog-history-container" rounded-lg p-4 data-v-90d60066><label cursor-pointer data-v-90d60066><div class="vp-nolebase-git-changelog-title flex select-none items-center justify-between" transition="color ease-in-out" text=&lt;sm:xs duration-200 data-v-90d60066><span class="vp-nolebase-git-changelog-last-edited-title inline-flex items-center gap-3" data-v-90d60066><div class=i-octicon:history-16 data-v-90d60066></div><span data-v-90d60066>最后编辑于 10 天前</span></span><div class=i-octicon:sort-desc-16 ml-auto mr-4 cursor-pointer data-v-90d60066></div><span class="vp-nolebase-git-changelog-view-full-history-title inline-flex cursor-pointer items-center gap-3" data-v-90d60066><span class=&lt;sm:hidden data-v-90d60066>查看完整历史</span><svg class="rotate-0 i-octicon:chevron-down-16" transition="transform ease-in-out" duration-200 data-v-90d60066></svg></span></div></label><div style=display:none class="grid grid-cols-[30px_auto] mt-3 gap-1.5 children:my-auto -ml-1.5" text=&lt;sm:xs data-v-90d60066><!--[--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-ad3e4745></div><div flex gap-1 align-baseline data-v-ad3e4745><a href=https://github.com/OOM-WG/SSU_Docs/commit/c067c23b60c96e643fbc3e7b8d6cb26387be46ce target=_blank class=no-icon data-v-ad3e4745><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-ad3e4745>c067c23</code></a><span data-v-ad3e4745>-</span><span data-v-ad3e4745><span class="text-sm &lt;sm:text-xs" data-v-ad3e4745>ShiroSU</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-ad3e4745></div><div flex gap-1 align-baseline data-v-ad3e4745><a href=https://github.com/OOM-WG/SSU_Docs/commit/5dca44f0962a9f44133cd798cd38c5a15ee5db2e target=_blank class=no-icon data-v-ad3e4745><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-ad3e4745>5dca44f</code></a><span data-v-ad3e4745>-</span><span data-v-ad3e4745><span class="text-sm &lt;sm:text-xs" data-v-ad3e4745>O.O.M. W.G.</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-ad3e4745></div><div flex gap-1 align-baseline data-v-ad3e4745><a href=https://github.com/OOM-WG/SSU_Docs/commit/e6f6f75f210dcaf439f3fdd2a74b2783f27b28d9 target=_blank class=no-icon data-v-ad3e4745><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-ad3e4745>e6f6f75</code></a><span data-v-ad3e4745>-</span><span data-v-ad3e4745><span class="text-sm &lt;sm:text-xs" data-v-ad3e4745>Add Japanese documentation and restructure navigation/localization</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-ad3e4745></div><div flex gap-1 align-baseline data-v-ad3e4745><a href=https://github.com/OOM-WG/SSU_Docs/commit/3a6eaaa872792ac1eba5a0f9611db958bd3fd798 target=_blank class=no-icon data-v-ad3e4745><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-ad3e4745>3a6eaaa</code></a><span data-v-ad3e4745>-</span><span data-v-ad3e4745><span class="text-sm &lt;sm:text-xs" data-v-ad3e4745>Refactor custom block styles and update navigation links for clarity</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-ad3e4745></div><div flex gap-1 align-baseline data-v-ad3e4745><a href=https://github.com/OOM-WG/SSU_Docs/commit/4260bd5abefbb930a399f7f88da204926c02d2be target=_blank class=no-icon data-v-ad3e4745><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-ad3e4745>4260bd5</code></a><span data-v-ad3e4745>-</span><span data-v-ad3e4745><span class="text-sm &lt;sm:text-xs" data-v-ad3e4745>Refactor font styles and update code snippet formatting</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-ad3e4745></div><div flex gap-1 align-baseline data-v-ad3e4745><a href=https://github.com/OOM-WG/SSU_Docs/commit/9217ed7ff31835564d1c012336247b1cad710658 target=_blank class=no-icon data-v-ad3e4745><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-ad3e4745>9217ed7</code></a><span data-v-ad3e4745>-</span><span data-v-ad3e4745><span class="text-sm &lt;sm:text-xs" data-v-ad3e4745>Update principle.md</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-ad3e4745></div><div flex gap-1 align-baseline data-v-ad3e4745><a href=https://github.com/OOM-WG/SSU_Docs/commit/6750c565a962a84048b72f02c9d427985a88c113 target=_blank class=no-icon data-v-ad3e4745><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-ad3e4745>6750c56</code></a><span data-v-ad3e4745>-</span><span data-v-ad3e4745><span class="text-sm &lt;sm:text-xs" data-v-ad3e4745>Update principle.md</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-ad3e4745></div><div flex gap-1 align-baseline data-v-ad3e4745><a href=https://github.com/OOM-WG/SSU_Docs/commit/9ce27eb6758e729eeafb9ec55852220ab7fff05e target=_blank class=no-icon data-v-ad3e4745><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-ad3e4745>9ce27eb</code></a><span data-v-ad3e4745>-</span><span data-v-ad3e4745><span class="text-sm &lt;sm:text-xs" data-v-ad3e4745>Update principle.md</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-ad3e4745></div><div flex gap-1 align-baseline data-v-ad3e4745><a href=https://github.com/OOM-WG/SSU_Docs/commit/545b031602514d93dbcd5c728ecb9a5729824ec0 target=_blank class=no-icon data-v-ad3e4745><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-ad3e4745>545b031</code></a><span data-v-ad3e4745>-</span><span data-v-ad3e4745><span class="text-sm &lt;sm:text-xs" data-v-ad3e4745>Update principle.md</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-ad3e4745></div><div flex gap-1 align-baseline data-v-ad3e4745><a href=https://github.com/OOM-WG/SSU_Docs/commit/cd2779c2e323c2838d6808850ebdf2c623fc5409 target=_blank class=no-icon data-v-ad3e4745><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-ad3e4745>cd2779c</code></a><span data-v-ad3e4745>-</span><span data-v-ad3e4745><span class="text-sm &lt;sm:text-xs" data-v-ad3e4745>feat: update navigation and sidebar links for improved user experience</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-ad3e4745></div><div flex gap-1 align-baseline data-v-ad3e4745><a href=https://github.com/OOM-WG/SSU_Docs/commit/240989b55615a15b0ab86debe3e795cf40ae0829 target=_blank class=no-icon data-v-ad3e4745><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-ad3e4745>240989b</code></a><span data-v-ad3e4745>-</span><span data-v-ad3e4745><span class="text-sm &lt;sm:text-xs" data-v-ad3e4745>更改页面路径</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-ad3e4745></div><div flex gap-1 align-baseline data-v-ad3e4745><a href=https://github.com/OOM-WG/SSU_Docs/commit/4d9c2bfbb12c9751979a1427da841894a62a81b7 target=_blank class=no-icon data-v-ad3e4745><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-ad3e4745>4d9c2bf</code></a><span data-v-ad3e4745>-</span><span data-v-ad3e4745><span class="text-sm &lt;sm:text-xs" data-v-ad3e4745>更新 code-demo.md</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-ad3e4745></div><div flex gap-1 align-baseline data-v-ad3e4745><a href=https://github.com/OOM-WG/SSU_Docs/commit/21a9de793a8d7653db0f61e78b8039c660b8fe40 target=_blank class=no-icon data-v-ad3e4745><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-ad3e4745>21a9de7</code></a><span data-v-ad3e4745>-</span><span data-v-ad3e4745><span class="text-sm &lt;sm:text-xs" data-v-ad3e4745>Add SakitinSU kernel privilege escalation documentation</span><!----><!----></span></div><!--]--><!--]--><!--]--></div></div><!--]--></div></div></main><footer class=VPDocFooter data-v-0e4ff3bd data-v-e772c1f8><!--[--><!--[--><!--[--><!--[--><!--[--><!--]--><div class=back-top-container style=display:none data-v-50fb5d70><svg class=progress-ring viewBox="0 0 100 100" data-v-50fb5d70><circle class=progress-ring-background cx=50 cy=50 r=42 data-v-50fb5d70></circle><circle class=progress-ring-circle cx=50 cy=50 r=42 style=stroke-dashoffset:263.89378290154264 data-v-50fb5d70></circle></svg><div class=vitepress-backTop-main title=返回顶部 data-v-50fb5d70><svg class=icon viewBox="0 0 1024 1024" data-v-50fb5d70><path d="M752.736 431.063C757.159 140.575 520.41 8.97 504.518 0.41V0l-0.45 0.205-0.41-0.205v0.41c-15.934 8.56-252.723 140.165-248.259 430.653-48.21 31.457-98.713 87.368-90.685 184.074 8.028 96.666 101.007 160.768 136.601 157.287 35.595-3.482 25.232-30.31 25.232-30.31l12.206-50.095s52.47 80.569 69.304 80.528c15.114-1.23 87-0.123 95.6 0h0.82c8.602-0.123 80.486-1.23 95.6 0 16.794 0 69.305-80.528 69.305-80.528l12.165 50.094s-10.322 26.83 25.272 30.31c35.595 3.482 128.574-60.62 136.602-157.286 8.028-96.665-42.475-152.617-90.685-184.074z m-248.669-4.26c-6.758-0.123-94.781-3.359-102.891-107.192 2.95-98.714 95.97-107.438 102.891-107.93 6.964 0.492 99.943 9.216 102.892 107.93-8.11 103.833-96.174 107.07-102.892 107.192z m-52.019 500.531c0 11.838-9.42 21.382-21.012 21.382a21.217 21.217 0 0 1-21.054-21.34V821.74c0-11.797 9.421-21.382 21.054-21.382 11.591 0 21.012 9.585 21.012 21.382v105.635z m77.333 57.222a21.504 21.504 0 0 1-21.34 21.626 21.504 21.504 0 0 1-21.34-21.626V827.474c0-11.96 9.543-21.668 21.299-21.668 11.796 0 21.38 9.708 21.38 21.668v157.082z m71.147-82.043c0 11.796-9.42 21.34-21.053 21.34a21.217 21.217 0 0 1-21.013-21.34v-75.367c0-11.755 9.421-21.299 21.013-21.299 11.632 0 21.053 9.544 21.053 21.3v75.366z" fill=#FFF data-v-50fb5d70></path></svg></div></div><!--]--><!--]--><!--]--><!--]--><div class=edit-info data-v-e772c1f8><div class=edit-link data-v-e772c1f8><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href=https://github.com/OOM-WG/SSU_Docs/edit/main/src/zh/ssu/principle.md target=_blank rel=noreferrer data-v-e772c1f8><!--[--><span class="vpi-square-pen edit-link-icon" data-v-e772c1f8></span>在 GitHub 上编辑此页面<!--]--></a></div><div class=last-updated data-v-e772c1f8><p class=VPLastUpdated data-v-e772c1f8 data-v-47f995b8>最后更新于:<time datetime=2025-08-20T02:11:18.000Z data-v-47f995b8></time></div></div><nav class=prev-next aria-labelledby=doc-footer-aria-label data-v-e772c1f8><span class=visually-hidden id=doc-footer-aria-label data-v-e772c1f8>Pager</span><div class=pager data-v-e772c1f8><a class="VPLink link pager-link prev" href=/ssu/origin data-v-e772c1f8><!--[--><span class=desc data-v-e772c1f8>上一页</span><span class=title data-v-e772c1f8>一切的起源</span><!--]--></a></div><div class=pager data-v-e772c1f8><a class="VPLink link pager-link next" href=/ssu/defense data-v-e772c1f8><!--[--><span class=desc data-v-e772c1f8>下一页</span><span class=title data-v-e772c1f8>面对质疑</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!----><!--]--></div><!--[--><css-render-style><style cssr-id=n-button>.n-button{margin:0;font-weight:var(--n-font-weight);line-height:1;font-family:inherit;padding:var(--n-padding);height:var(--n-height);font-size:var(--n-font-size);border-radius:var(--n-border-radius);color:var(--n-text-color);background-color:var(--n-color);width:var(--n-width);white-space:nowrap;outline:0;position:relative;z-index:auto;border:none;display:inline-flex;flex-wrap:nowrap;flex-shrink:0;align-items:center;justify-content:center;user-select:none;-webkit-user-select:none;text-align:center;cursor:pointer;text-decoration:none;transition:color .3s var(--n-bezier),background-color .3s var(--n-bezier),opacity .3s var(--n-bezier),border-color .3s var(--n-bezier)}.n-button.n-button--color .n-button__border{border-color:var(--n-border-color)}.n-button.n-button--color.n-button--disabled .n-button__border{border-color:var(--n-border-color-disabled)}.n-button.n-button--color:not(.n-button--disabled):focus .n-button__state-border{border-color:var(--n-border-color-focus)}.n-button.n-button--color:not(.n-button--disabled):hover .n-button__state-border{border-color:var(--n-border-color-hover)}.n-button.n-button--color:not(.n-button--disabled):active .n-button__state-border{border-color:var(--n-border-color-pressed)}.n-button.n-button--color:not(.n-button--disabled).n-button--pressed .n-button__state-border{border-color:var(--n-border-color-pressed)}.n-button.n-button--disabled{background-color:var(--n-color-disabled);color:var(--n-text-color-disabled)}.n-button.n-button--disabled .n-button__border{border:var(--n-border-disabled)}.n-button:not(.n-button--disabled):focus{background-color:var(--n-color-focus);color:var(--n-text-color-focus)}.n-button:not(.n-button--disabled):focus .n-button__state-border{border:var(--n-border-focus)}.n-button:not(.n-button--disabled):hover{background-color:var(--n-color-hover);color:var(--n-text-color-hover)}.n-button:not(.n-button--disabled):hover .n-button__state-border{border:var(--n-border-hover)}.n-button:not(.n-button--disabled):active{background-color:var(--n-color-pressed);color:var(--n-text-color-pressed)}.n-button:not(.n-button--disabled):active .n-button__state-border{border:var(--n-border-pressed)}.n-button:not(.n-button--disabled).n-button--pressed{background-color:var(--n-color-pressed);color:var(--n-text-color-pressed)}.n-button:not(.n-button--disabled).n-button--pressed .n-button__state-border{border:var(--n-border-pressed)}.n-button.n-button--loading{cursor:wait}.n-button .n-base-wave{pointer-events:none;top:0;right:0;bottom:0;left:0;animation-iteration-count:1;animation-duration:var(--n-ripple-duration);animation-timing-function:var(--n-bezier-ease-out),var(--n-bezier-ease-out)}.n-button .n-base-wave.n-base-wave--active{z-index:1;animation-name:button-wave-spread,button-wave-opacity}.n-button .n-button__border,.n-button .n-button__state-border{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;transition:border-color .3s var(--n-bezier);pointer-events:none}.n-button .n-button__border{border:var(--n-border)}.n-button .n-button__state-border{border:var(--n-border);border-color:#0000;z-index:1}.n-button .n-button__icon{margin:var(--n-icon-margin);margin-left:0;height:var(--n-icon-size);width:var(--n-icon-size);max-width:var(--n-icon-size);font-size:var(--n-icon-size);position:relative;flex-shrink:0}.n-button .n-button__icon .n-icon-slot{height:var(--n-icon-size);width:var(--n-icon-size);position:absolute;left:0;top:50%;transform:translateY(-50%);display:flex;align-items:center;justify-content:center}.n-button .n-button__icon .n-icon-slot.icon-switch-transition-enter-from,.n-button .n-button__icon .n-icon-slot.icon-switch-transition-leave-to{transform:translateY(-50%) scale(.75);left:0;top:50%;opacity:0}.n-button .n-button__icon .n-icon-slot.icon-switch-transition-enter-to,.n-button .n-button__icon .n-icon-slot.icon-switch-transition-leave-from{transform:scale(1) translateY(-50%);left:0;top:50%;opacity:1}.n-button .n-button__icon .n-icon-slot.icon-switch-transition-enter-active,.n-button .n-button__icon .n-icon-slot.icon-switch-transition-leave-active{transform-origin:center;position:absolute;left:0;top:50%;transition:all .3s cubic-bezier(.4, 0, .2, 1)!important}.n-button .n-button__icon.fade-in-width-expand-transition-enter-to,.n-button .n-button__icon.fade-in-width-expand-transition-leave-from{opacity:1}.n-button .n-button__icon.fade-in-width-expand-transition-enter-from,.n-button .n-button__icon.fade-in-width-expand-transition-leave-to{opacity:0!important;margin-left:0!important;margin-right:0!important}.n-button .n-button__icon.fade-in-width-expand-transition-leave-active{overflow:hidden;transition:opacity .2s cubic-bezier(.4, 0, .2, 1),max-width .2s cubic-bezier(.4, 0, .2, 1) .1s,margin-left .2s cubic-bezier(.4, 0, .2, 1) .1s,margin-right .2s cubic-bezier(.4, 0, .2, 1) .1s}.n-button .n-button__icon.fade-in-width-expand-transition-enter-active{overflow:hidden;transition:opacity .2s cubic-bezier(.4, 0, .2, 1) .1s,max-width .2s cubic-bezier(.4, 0, .2, 1),margin-left .2s cubic-bezier(.4, 0, .2, 1),margin-right .2s cubic-bezier(.4, 0, .2, 1)}.n-button .n-button__content{display:flex;align-items:center;flex-wrap:nowrap;min-width:0}.n-button .n-button__content~.n-button__icon{margin:var(--n-icon-margin);margin-right:0}.n-button.n-button--block{display:flex;width:100%}.n-button.n-button--dashed .n-button__border,.n-button.n-button--dashed .n-button__state-border{border-style:dashed!important}.n-button.n-button--disabled{cursor:not-allowed;opacity:var(--n-opacity-disabled)}@keyframes button-wave-spread{from{box-shadow:0 0 .5px 0 var(--n-ripple-color)}to{box-shadow:0 0 .5px 4.5px var(--n-ripple-color)}}@keyframes button-wave-opacity{from{opacity:var(--n-wave-opacity)}to{opacity:0}}</style><style cssr-id=n-global>body{margin:0;font-size:14px;font-family:v-sans,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";line-height:1.6;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}body input{font-family:inherit;font-size:inherit}</style><style cssr-id=__button-elmmp>.__button-elmmp{--n-bezier:cubic-bezier(.4, 0, .2, 1);--n-bezier-ease-out:cubic-bezier(0, 0, .2, 1);--n-ripple-duration:.6s;--n-opacity-disabled:0.5;--n-wave-opacity:0.6;--n-font-weight:400;--n-color:#18a058;--n-color-hover:#36ad6a;--n-color-pressed:#0c7a43;--n-color-focus:#36ad6a;--n-color-disabled:#18a058;--n-ripple-color:#18a058;--n-text-color:#FFF;--n-text-color-hover:#FFF;--n-text-color-pressed:#FFF;--n-text-color-focus:#FFF;--n-text-color-disabled:#FFF;--n-border:1px solid #18a058;--n-border-hover:1px solid #36ad6a;--n-border-pressed:1px solid #0c7a43;--n-border-focus:1px solid #36ad6a;--n-border-disabled:1px solid #18a058;--n-width:34px;--n-height:34px;--n-font-size:14px;--n-padding:initial;--n-icon-size:18px;--n-icon-margin:6px;--n-border-radius:34px}</style><style cssr-id=n-icon>.n-icon{height:1em;width:1em;line-height:1em;text-align:center;display:inline-block;position:relative;fill:currentColor}.n-icon.n-icon--color-transition{transition:color .3s var(--n-bezier)}.n-icon.n-icon--depth{color:var(--n-color)}.n-icon.n-icon--depth svg{opacity:var(--n-opacity);transition:opacity .3s var(--n-bezier)}.n-icon svg{height:1em;width:1em}</style><style cssr-id=__icon-d>.__icon-d{--n-bezier:cubic-bezier(.4, 0, .2, 1);--n-color: ;--n-opacity: }</style><style cssr-id=n-base-wave>.n-base-wave{position:absolute;left:0;right:0;top:0;bottom:0;border-radius:inherit}</style><style cssr-id=n-carousel>.n-carousel{position:relative;width:100%;height:100%;touch-action:pan-y;overflow:hidden}.n-carousel .n-carousel__slides{display:flex;width:100%;height:100%;transition-timing-function:var(--n-bezier);transition-property:transform}.n-carousel .n-carousel__slides .n-carousel__slide{flex-shrink:0;position:relative;width:100%;height:100%;outline:0;overflow:hidden}.n-carousel .n-carousel__slides .n-carousel__slide>img{display:block}.n-carousel .n-carousel__dots{position:absolute;display:flex;flex-wrap:nowrap}.n-carousel .n-carousel__dots.n-carousel__dots--dot .n-carousel__dot{height:var(--n-dot-size);width:var(--n-dot-size);background-color:var(--n-dot-color);border-radius:50%;cursor:pointer;transition:box-shadow .3s var(--n-bezier),background-color .3s var(--n-bezier);outline:0}.n-carousel .n-carousel__dots.n-carousel__dots--dot .n-carousel__dot:focus{background-color:var(--n-dot-color-focus)}.n-carousel .n-carousel__dots.n-carousel__dots--dot .n-carousel__dot.n-carousel__dot--active{background-color:var(--n-dot-color-active)}.n-carousel .n-carousel__dots.n-carousel__dots--line .n-carousel__dot{border-radius:9999px;width:var(--n-dot-line-width);height:4px;background-color:var(--n-dot-color);cursor:pointer;transition:width .3s var(--n-bezier),box-shadow .3s var(--n-bezier),background-color .3s var(--n-bezier);outline:0}.n-carousel .n-carousel__dots.n-carousel__dots--line .n-carousel__dot:focus{background-color:var(--n-dot-color-focus)}.n-carousel .n-carousel__dots.n-carousel__dots--line .n-carousel__dot.n-carousel__dot--active{width:var(--n-dot-line-width-active);background-color:var(--n-dot-color-active)}.n-carousel .n-carousel__arrow{transition:background-color .3s var(--n-bezier);cursor:pointer;height:28px;width:28px;display:flex;align-items:center;justify-content:center;background-color:rgba(255,255,255,.2);color:var(--n-arrow-color);border-radius:8px;user-select:none;-webkit-user-select:none;font-size:18px}.n-carousel .n-carousel__arrow svg{height:1em;width:1em}.n-carousel .n-carousel__arrow:hover{background-color:rgba(255,255,255,.3)}.n-carousel.n-carousel--vertical{touch-action:pan-x}.n-carousel.n-carousel--vertical .n-carousel__slides{flex-direction:column}.n-carousel.n-carousel--vertical.n-carousel--fade .n-carousel__slide{top:50%;left:unset;transform:translateY(-50%)}.n-carousel.n-carousel--vertical.n-carousel--card .n-carousel__slide{top:50%;left:unset;transform:translateY(-50%) translateZ(-400px)}.n-carousel.n-carousel--vertical.n-carousel--card .n-carousel__slide.n-carousel__slide--current{transform:translateY(-50%) translateZ(0)}.n-carousel.n-carousel--vertical.n-carousel--card .n-carousel__slide.n-carousel__slide--prev{transform:translateY(-100%) translateZ(-200px)}.n-carousel.n-carousel--vertical.n-carousel--card .n-carousel__slide.n-carousel__slide--next{transform:translateY(0) translateZ(-200px)}.n-carousel.n-carousel--usercontrol .n-carousel__slides>div{position:absolute;top:50%;left:50%;width:100%;height:100%;transform:translate(-50%,-50%)}.n-carousel.n-carousel--left .n-carousel__dots{transform:translateY(-50%);top:50%;left:12px;flex-direction:column}.n-carousel.n-carousel--left .n-carousel__dots.n-carousel__dots--line .n-carousel__dot{width:4px;height:var(--n-dot-line-width);margin:4px 0;transition:height .3s var(--n-bezier),box-shadow .3s var(--n-bezier),background-color .3s var(--n-bezier);outline:0}.n-carousel.n-carousel--left .n-carousel__dots.n-carousel__dots--line .n-carousel__dot.n-carousel__dot--active{height:var(--n-dot-line-width-active)}.n-carousel.n-carousel--left .n-carousel__dot{margin:4px 0}.n-carousel .n-carousel__arrow-group{position:absolute;display:flex;flex-wrap:nowrap}.n-carousel.n-carousel--vertical .n-carousel__arrow{transform:rotate(90deg)}.n-carousel.n-carousel--show-arrow.n-carousel--bottom .n-carousel__dots{transform:translateX(0);bottom:18px;left:18px}.n-carousel.n-carousel--show-arrow.n-carousel--top .n-carousel__dots{transform:translateX(0);top:18px;left:18px}.n-carousel.n-carousel--show-arrow.n-carousel--left .n-carousel__dots{transform:translateX(0);top:18px;left:18px}.n-carousel.n-carousel--show-arrow.n-carousel--right .n-carousel__dots{transform:translateX(0);top:18px;right:18px}.n-carousel.n-carousel--left .n-carousel__arrow-group{bottom:12px;left:12px;flex-direction:column}.n-carousel.n-carousel--left .n-carousel__arrow-group>:first-child{margin-bottom:12px}.n-carousel.n-carousel--right .n-carousel__dots{transform:translateY(-50%);top:50%;right:12px;flex-direction:column}.n-carousel.n-carousel--right .n-carousel__dots.n-carousel__dots--line .n-carousel__dot{width:4px;height:var(--n-dot-line-width);margin:4px 0;transition:height .3s var(--n-bezier),box-shadow .3s var(--n-bezier),background-color .3s var(--n-bezier);outline:0}.n-carousel.n-carousel--right .n-carousel__dots.n-carousel__dots--line .n-carousel__dot.n-carousel__dot--active{height:var(--n-dot-line-width-active)}.n-carousel.n-carousel--right .n-carousel__dot{margin:4px 0}.n-carousel.n-carousel--right .n-carousel__arrow-group{bottom:12px;right:12px;flex-direction:column}.n-carousel.n-carousel--right .n-carousel__arrow-group>:first-child{margin-bottom:12px}.n-carousel.n-carousel--top .n-carousel__dots{transform:translateX(-50%);top:12px;left:50%}.n-carousel.n-carousel--top .n-carousel__dots.n-carousel__dots--line .n-carousel__dot{margin:0 4px}.n-carousel.n-carousel--top .n-carousel__dot{margin:0 4px}.n-carousel.n-carousel--top .n-carousel__arrow-group{top:12px;right:12px}.n-carousel.n-carousel--top .n-carousel__arrow-group>:first-child{margin-right:12px}.n-carousel.n-carousel--bottom .n-carousel__dots{transform:translateX(-50%);bottom:12px;left:50%}.n-carousel.n-carousel--bottom .n-carousel__dots.n-carousel__dots--line .n-carousel__dot{margin:0 4px}.n-carousel.n-carousel--bottom .n-carousel__dot{margin:0 4px}.n-carousel.n-carousel--bottom .n-carousel__arrow-group{bottom:12px;right:12px}.n-carousel.n-carousel--bottom .n-carousel__arrow-group>:first-child{margin-right:12px}.n-carousel.n-carousel--fade .n-carousel__slide{position:absolute;opacity:0;transition-property:opacity;pointer-events:none}.n-carousel.n-carousel--fade .n-carousel__slide.n-carousel__slide--current{opacity:1;pointer-events:auto}.n-carousel.n-carousel--card .n-carousel__slides{perspective:1000px}.n-carousel.n-carousel--card .n-carousel__slide{position:absolute;left:50%;opacity:0;transform:translateX(-50%) translateZ(-400px);transition-property:opacity,transform}.n-carousel.n-carousel--card .n-carousel__slide.n-carousel__slide--current{opacity:1;transform:translateX(-50%) translateZ(0);z-index:1}.n-carousel.n-carousel--card .n-carousel__slide.n-carousel__slide--prev{opacity:.4;transform:translateX(-100%) translateZ(-200px)}.n-carousel.n-carousel--card .n-carousel__slide.n-carousel__slide--next{opacity:.4;transform:translateX(0) translateZ(-200px)}</style><style cssr-id=__carousel>.__carousel{--n-bezier:cubic-bezier(.4, 0, .2, 1);--n-dot-color:rgba(255, 255, 255, .3);--n-dot-color-focus:rgba(255, 255, 255, .5);--n-dot-color-active:rgba(255, 255, 255, 1);--n-dot-size:8px;--n-dot-line-width:16px;--n-dot-line-width-active:24px;--n-arrow-color:#eee}</style></css-render-style><vitepress-path>/ssu/principle</vitepress-path><!--]--><!--]--></div>